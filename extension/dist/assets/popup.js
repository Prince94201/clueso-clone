import"./modulepreload-polyfill-B5Qt9EMX.js";const d="http://localhost:3000";async function l(){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!t?.id)throw new Error("No active tab");return t.id}async function h(){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});return t}function n(t){return document.getElementById(t)}function s(t){const e=n("status");e&&(e.textContent=t)}function f(t){const e=n("auth");e&&(e.textContent=t)}function w(t){const e=n("authHint");e&&(e.style.display=t?"block":"none")}function a(t){const e=n("recordSection");e&&e.classList.toggle("hidden",!t);const o=n("chooseRecord"),i=n("chooseUpload");o&&o.classList.toggle("hidden",t),i&&i.classList.toggle("hidden",t)}async function r(){const e=!!(await chrome.runtime.sendMessage({type:"AUTH_STATUS"}))?.signedIn;f(e?"Connected":"Not connected"),w(!e)}async function g(){const t=await h();(t?.url??"").startsWith(d)&&t?.id&&await chrome.scripting.executeScript({target:{tabId:t.id},func:()=>{window.postMessage({type:"CLUESO_CLONE_REQUEST_TOKEN"},"*")}})}async function c(){const e=!!(await chrome.runtime.sendMessage({type:"GET_STATE"}))?.recording;n("start").disabled=e,n("stop").disabled=!e,s(e?"Recording…":"Idle"),e&&a(!0)}async function p(){const t=await l(),e=n("mic").checked;s("Starting…");const o=await chrome.runtime.sendMessage({type:"START_RECORDING",tabId:t,withMic:e});if(!o?.ok)throw new Error(o?.error??"Failed to start");a(!0),await c()}async function m(){s("Stopping…");const t=await chrome.runtime.sendMessage({type:"STOP_RECORDING"});if(!t?.ok)throw new Error(t?.error??"Failed to stop");const e=t?.result?.result;e?.url&&e?.filename&&await chrome.downloads.download({url:e.url,filename:e.filename,saveAs:!0}),await c()}async function u(t){await chrome.tabs.create({url:`${d}${t}`})}n("chooseRecord")?.addEventListener("click",()=>{u("/dashboard?record=1").catch(()=>{})});n("chooseUpload")?.addEventListener("click",()=>{u("/videos/upload").catch(()=>{})});n("back")?.addEventListener("click",()=>{a(!1)});n("start")?.addEventListener("click",()=>{p().catch(t=>s(String(t?.message??t)))});n("stop")?.addEventListener("click",()=>{m().catch(t=>s(String(t?.message??t)))});(async()=>{a(!1),await r(),await g(),await r(),await c()})().catch(()=>{});
//# sourceMappingURL=popup.js.map
